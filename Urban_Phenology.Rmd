---
title: "Urban Phenology Project"
author: "Victoria Garfield"
date: "2025-11-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(sf)
library(terra)
library(tidyverse)
library(terra)
```



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

. Introduce the problem and explain why: 
Urbanization impacts local climate patterns and species interactions with the surrounding land; this leads to ecological shifts, such as the timing of events like flowering or migration (Park et al. 2023; Leong 2014). These changes in our environments often end up leading to changes in phenology (Wu et al 2025). Changes in phenology can disrupt the surrounding ecosystems, this can impact the relationship between pollinators and plants. This in turn impacts seasonal changes, coming earlier or later, flowering times, and bee distribution (Park et al. 2023; Leong 2014).  Urbanized areas tend to have warmer seasons, but the understanding of this phenomenon is not well known. Understanding why these kinds of patterns differ in urban and rural areas is important. As we see an increase in urbanization and climate change, the observation between rural and urbanized areas can help us prepare and understand what we may see more widespread in the future. 

2. Past work and data available
Past work on the studies of urbanized areas compared to rural found that urban environments tend to have earlier flowering times and differing arrival times of bees within these areas compared to rural areas. (Wu et al. 2025; Li, X et al. 2017). With this in mind, the observation of environmental changes like reduced vegetation, higher surface temperatures and carbon clusters, via MODIS or NDVI can help us measure these traits. The main setback to these methods of collecting data would be coarse spatial scales. This problem prevents us from looking and finer details of these urbanized areas, and potentially missing rare or special species that may benefit from these urbanized areas. With more detailed/smaller scale datasets like the Oregon Bee Atlas (OBA) and the Global Biodiversity Information Facility (GBIF) can grant us insight on localized temporal changes in species activity. In conjunction with environmental datasets like PRISM climate data and NLCD land cover data set, we can provide a more precise scale of what drives these differences between urban and rural areas.
3. Purpose of the study


To address the questions of how:
Further refine your approach (e.g., what data will you combine/transorm to a new type, how will you address the question)
Justify why this is needed now (e.g., visualization to test a new dimension of the question or better convey an old one)

4. Hypotheses/questions:
My hypotheses and questions are as follows, Hypothesis one, how to seasonal changes of urban environments compared to rural areas impact bee phrenology. Hypothesis two would be what is driving these changes. For hypothesis three, what causes these differences in phenology. 
9.5.2 Dataset identification
The data I will be using primarily is Oregon Bee Atlas (OBA) dataset, in conjunction with the National Land Cover Database (NLCD).  NLCD will allow me to look at urbanized areas and forest cover. This is useful because I will be able to compare these two and see how urbanization has impacted bee phenology. I like this dataset because I can also look at how forest cover has changed over times, whether that is from wildfires or human interference, and infer that way. 

```{r}
library(terra)

# Load the raster
r <- rast("/Users/vgarfield03/Downloads/ds-environ-main/BeeUrbanizationProject/urban-phenology-project")

# Quick check
r

# Check CRS
crs_info <- crs(r, describe = TRUE)
print(crs_info)

# Check just the WKT/Proj4 string
crs_string <- crs(r)
print(crs_string)

crs_info <- st_crs(crs_string)
print(crs_info)

##crs(r) <- "EPSG:26910"

## length is in meters 
```

```{r}
library(sf)
library(terra)
library(tidyverse)

## Clean OBA data loading...
oba <- read_csv("/Users/vgarfield03/Downloads/ds-environ-main/data/OBA_2018-2023.csv")

## in st_as_sf.data.frame(oba, coords = c("Dec. Long.", "Dec. Lat."),  :  missing values in coordinates not allowed - was an error, so I am going back to removed rows with missing coordinates. 
oba_clean <- oba %>% 
  filter(!is.na(`Dec. Lat.`) & (`Dec. Long.`))

## converting to sf for GIS, updated oba into oba_clean
oba_sf <- st_as_sf(oba_clean, coords = c("Dec. Long.", "Dec. Lat."), crs = 4326)
## crs is the world reference systems

#Loading NLCD rasters 
nlcd_lc <- rast("Annual_NLCD_LndCov_2020_CU_C1V1.tif")
nlcd <- rast("Annual_NLCD_FctImp_2020_CU_C1V1.tif")


## removing NA values 
oba_clean <- oba %>% drop_na(`Dec. Long.`, `Dec. Long.`)


#Getting values into my OBA data 
oba$landcover <- extract(nlcd_lc, vect(oba_sf))[,2]
oba$impervious <- extract(nlcd_imp, vect(oba_sf))[,2]


```

